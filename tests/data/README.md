# Test Data Directory

This directory contains test data, recordings, and fixtures for Kaiak integration tests.

## Structure

```
tests/data/
├── recordings/          # TestProvider replay recordings (JSON format)
├── fixtures/            # Static test files and sample data
├── samples/             # Sample workspace configurations and code examples
└── README.md           # This file
```

## recordings/

Contains JSON recordings generated by the TestProvider for each test scenario. These recordings capture API interactions for replay in CI/PR environments without requiring external API calls.

**Naming Convention**: `{test_name}.json`

Examples:
- `configure_basic_workspace.json`
- `generate_fix_basic.json`
- `delete_session_basic.json`

Each recording file contains:
- Test metadata (name, recorded time, version)
- Sequence of request/response interactions
- Environment information
- Execution metadata (timings, success status)

## fixtures/

Static test data and configuration files used across multiple tests.

Examples:
- Sample Java/Rust code with migration issues
- Configuration templates
- Mock response data

## samples/

Sample workspace configurations and example projects for testing different scenarios:
- Java 8 → Java 17 migration samples
- Rust edition migration samples
- Various code patterns and deprecated API usage examples

## Usage in Tests

### TestProvider Recordings

```rust
use common::{TestProvider, TestProviderMode};

let mut test_provider = TestProvider::new("test_name")?;
let result = test_provider.interact("interaction_type", request).await?;
```

### Using Fixtures

```rust
use std::path::Path;

let fixture_path = Path::new("tests/data/fixtures/sample_java_project");
// Use fixture data in tests
```

## Environment Modes

- **Record Mode** (`KAIAK_TEST_MODE=record`): Generate new recordings from real API calls
- **Replay Mode** (`KAIAK_TEST_MODE=replay`): Use existing recordings (default in CI)
- **Live Mode** (`KAIAK_TEST_MODE=live`): Pass through to real APIs (development only)

## CI/CD Integration

In GitHub Actions, tests automatically run in replay mode to ensure:
- No external API dependencies
- Consistent test results
- Fast execution
- No API quota usage

## Adding New Test Recordings

1. Set up your test scenario
2. Run with `KAIAK_TEST_MODE=record`
3. Verify the generated recording in `recordings/`
4. Commit the recording file to version control
5. CI will automatically use the recording for future runs

## Security Notes

- Recordings contain mock data only - no real API keys or sensitive information
- All timestamps and IDs are generated for testing purposes
- Production API responses are sanitized before recording